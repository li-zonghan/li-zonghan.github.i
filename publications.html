---
layout: default
title: Publications
navbar_title: Publications
body_attr: >-
  data-spy="scroll" data-target="#navbar-year" data-offset="100"
---

{% comment %}
 先找出：没有 date 且 pub_post == 'Under review.' 的条目
{% endcomment %}
{% assign under_review_pubs = site.publications 
  | where_exp: "item", "item.date == nil and item.pub_post == 'Under review.'"
%}

{% comment %}
 其它的：要正常按年份分组
 先去掉上面已经被分到 under_review 的条目，再 group_by_exp
{% endcomment %}
{% assign normal_pubs = site.publications 
  | reject_exp: "item", "item.date == nil and item.pub_post == 'Under review.'"
  | sort: "date"
  | reverse
  | group_by_exp: "item", "item.date | date: '%Y'"
%}

<div class="row">
  <div class="col-12 col-lg-10">
    {% comment %}
      先输出 Under review 部分（如果有的话）
    {% endcomment %}
    {% if under_review_pubs.size > 0 %}
      <h2 class="pt-4" id="year-under-review">Under review</h2>
      <div class="my-0 p-0 bg-white shadow-sm rounded-sm">
        {% for item in under_review_pubs %}
          {% include widgets/publication_item.html 
             item=item 
             hide_bottom_border=forloop.last 
             first=forloop.first 
             last=forloop.last %}
        {% endfor %}
      </div>
    {% endif %}

    {% comment %}
      再输出正常按年份分组的部分
    {% endcomment %}
    {% for year in normal_pubs %}
      <h2 class="pt-4" id="year-{{ year.name }}">{{ year.name }}</h2>
      <div class="my-0 p-0 bg-white shadow-sm rounded-sm">
        {% for item in year.items %}
          {% include widgets/publication_item.html 
             item=item 
             hide_bottom_border=forloop.last 
             first=forloop.first 
             last=forloop.last %}
        {% endfor %}
      </div>
    {% endfor %}
  </div>

  <div class="col-2 d-none d-lg-block">
    <div id="navbar-year" class="nav nav-pills flex-column sticky-top" style="top: 80px">
      {% comment %}
        如果有 Under review 的文章，就在导航栏加一个跳转
      {% endcomment %}
      {% if under_review_pubs.size > 0 %}
        <a class="nav-link d-block" href="#year-under-review">Under review</a>
      {% endif %}

      {% comment %}
        原先的年份导航
      {% endcomment %}
      {% for year in normal_pubs %}
        <a class="nav-link d-block" href="#year-{{ year.name }}">{{ year.name }}</a>
      {% endfor %}
    </div>
  </div>
</div>
